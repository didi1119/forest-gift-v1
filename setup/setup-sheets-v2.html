<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets 設定工具 v2.0 - 佣金管理版</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700&family=Noto+Sans+TC:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #FDFBF8; color: #5C544B; }
        h1, h2, h3, .font-serif { font-family: 'Noto Serif TC', serif; }
        .brand-accent { color: #2E4B36; }
        .brand-card { background-color: #FFFFFF; border: 1px solid #EAE6E1; border-radius: 1.5rem; box-shadow: 0 10px 40px rgba(0,0,0,0.05); }
        .code-block { background-color: #1F2937; color: #F9FAFB; padding: 1rem; border-radius: 0.5rem; font-family: monospace; font-size: 0.9rem; white-space: pre-wrap; overflow-x: auto; }
    </style>
</head>
<body class="antialiased min-h-screen py-8">
    <div class="max-w-6xl mx-auto px-6">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold brand-accent mb-4">Google Sheets 設定工具 v2.0</h1>
            <p class="text-lg text-stone-600">佣金管理系統專用版本</p>
            <div class="bg-amber-50 p-4 rounded-lg mt-4">
                <p class="text-amber-800 font-semibold">🆕 新增功能：完整的佣金管理、等級制度、匯款資訊追蹤</p>
            </div>
        </header>

        <div class="space-y-8">
            <!-- 步驟1: 建立工作表 -->
            <div class="brand-card p-6">
                <h2 class="font-serif text-2xl font-semibold brand-accent mb-4">步驟1: 建立 Google Sheets 工作表</h2>
                <p class="text-stone-600 mb-4">請在您的 Google Sheets 中建立以下4個工作表，並設定正確的標題行：</p>
                
                <div class="space-y-6">
                    <!-- Partners 工作表 -->
                    <div>
                        <h3 class="text-lg font-semibold text-green-700 mb-2">📊 Partners 工作表（聯盟夥伴）</h3>
                        <p class="text-sm text-stone-600 mb-2">在 A1 開始輸入以下標題（一行一個欄位）：</p>
                        <div class="code-block text-xs">id	partner_code	name	email	phone	level	level_progress	total_successful_referrals	commission_preference	total_commission_earned	total_commission_paid	pending_commission	bank_name	bank_branch	account_holder	account_number	first_referral_bonus_claimed	status	landing_link	coupon_link	coupon_code	coupon_url	notes	created_at	updated_at</div>
                        <button onclick="copyToClipboard('partners-headers')" class="mt-2 px-3 py-1 bg-green-600 text-white rounded text-sm">複製標題行</button>
                        <div id="partners-headers" class="hidden">id	partner_code	name	email	phone	level	level_progress	total_successful_referrals	commission_preference	total_commission_earned	total_commission_paid	pending_commission	bank_name	bank_branch	account_holder	account_number	first_referral_bonus_claimed	status	landing_link	coupon_link	coupon_code	coupon_url	notes	created_at	updated_at</div>
                    </div>

                    <!-- Bookings 工作表 -->
                    <div>
                        <h3 class="text-lg font-semibold text-blue-700 mb-2">🏠 Bookings 工作表（訂房記錄）</h3>
                        <p class="text-sm text-stone-600 mb-2">在 A1 開始輸入以下標題：</p>
                        <div class="code-block text-xs">id	partner_code	guest_name	guest_phone	guest_email	checkin_date	checkout_date	room_price	booking_source	stay_status	payment_status	commission_status	commission_amount	commission_type	is_first_referral_bonus	first_referral_bonus_amount	manually_confirmed_by	manually_confirmed_at	notes	created_at	updated_at</div>
                        <button onclick="copyToClipboard('bookings-headers')" class="mt-2 px-3 py-1 bg-blue-600 text-white rounded text-sm">複製標題行</button>
                        <div id="bookings-headers" class="hidden">id	partner_code	guest_name	guest_phone	guest_email	checkin_date	checkout_date	room_price	booking_source	stay_status	payment_status	commission_status	commission_amount	commission_type	is_first_referral_bonus	first_referral_bonus_amount	manually_confirmed_by	manually_confirmed_at	notes	created_at	updated_at</div>
                    </div>

                    <!-- Payouts 工作表 -->
                    <div>
                        <h3 class="text-lg font-semibold text-purple-700 mb-2">💰 Payouts 工作表（佣金發放）</h3>
                        <p class="text-sm text-stone-600 mb-2">在 A1 開始輸入以下標題：</p>
                        <div class="code-block text-xs">id	partner_code	payout_type	amount	related_booking_ids	payout_method	payout_status	bank_transfer_date	bank_transfer_reference	accommodation_voucher_code	notes	created_by	created_at	updated_at</div>
                        <button onclick="copyToClipboard('payouts-headers')" class="mt-2 px-3 py-1 bg-purple-600 text-white rounded text-sm">複製標題行</button>
                        <div id="payouts-headers" class="hidden">id	partner_code	payout_type	amount	related_booking_ids	payout_method	payout_status	bank_transfer_date	bank_transfer_reference	accommodation_voucher_code	notes	created_by	created_at	updated_at</div>
                    </div>

                    <!-- Clicks 工作表 -->
                    <div>
                        <h3 class="text-lg font-semibold text-orange-700 mb-2">👆 Clicks 工作表（點擊記錄）</h3>
                        <p class="text-sm text-stone-600 mb-2">在 A1 開始輸入以下標題：</p>
                        <div class="code-block text-xs">id	partner_code	timestamp	ip_address	user_agent	referrer	destination	utm_source	utm_medium	utm_campaign	session_id	country	city	device	status	created_at	gift_card_selected</div>
                        <button onclick="copyToClipboard('clicks-headers')" class="mt-2 px-3 py-1 bg-orange-600 text-white rounded text-sm">複製標題行</button>
                        <div id="clicks-headers" class="hidden">id	partner_code	timestamp	ip_address	user_agent	referrer	destination	utm_source	utm_medium	utm_campaign	session_id	country	city	device	status	created_at	gift_card_selected</div>
                    </div>
                </div>
            </div>

            <!-- 步驟2: 欄位說明 -->
            <div class="brand-card p-6">
                <h2 class="font-serif text-2xl font-semibold brand-accent mb-4">步驟2: 重要欄位說明</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-lg font-semibold text-green-700 mb-3">Partners 表重要欄位</h3>
                        <ul class="text-sm space-y-1 text-stone-600">
                            <li><strong>level:</strong> LV1_INSIDER / LV2_GUIDE / LV3_GUARDIAN</li>
                            <li><strong>level_progress:</strong> 本年度成功推薦數</li>
                            <li><strong>commission_preference:</strong> CASH / ACCOMMODATION</li>
                            <li><strong>total_commission_earned:</strong> 累積佣金總額</li>
                            <li><strong>pending_commission:</strong> 未支付佣金</li>
                            <li><strong>first_referral_bonus_claimed:</strong> TRUE/FALSE</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h3 class="text-lg font-semibold text-blue-700 mb-3">Bookings 表重要欄位</h3>
                        <ul class="text-sm space-y-1 text-stone-600">
                            <li><strong>stay_status:</strong> PENDING / CHECKED_IN / COMPLETED / CANCELLED</li>
                            <li><strong>commission_status:</strong> NOT_ELIGIBLE / CALCULATED / PAID</li>
                            <li><strong>commission_type:</strong> CASH / ACCOMMODATION</li>
                            <li><strong>is_first_referral_bonus:</strong> TRUE/FALSE</li>
                            <li><strong>first_referral_bonus_amount:</strong> 首次推薦獎勵金額</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- 步驟3: 佣金計算規則 -->
            <div class="brand-card p-6">
                <h2 class="font-serif text-2xl font-semibold brand-accent mb-4">步驟3: 佣金計算規則設定</h2>
                
                <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg">
                    <h3 class="text-lg font-semibold text-green-800 mb-4">💰 佣金等級制度</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white p-4 rounded-lg border-l-4 border-green-500">
                            <h4 class="font-semibold text-green-700">LV1 知音大使</h4>
                            <p class="text-sm text-stone-600 mt-1">1000住宿金 或 500現金</p>
                            <p class="text-xs text-green-600 mt-2">起始等級</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg border-l-4 border-blue-500">
                            <h4 class="font-semibold text-blue-700">LV2 森林嚮導</h4>
                            <p class="text-sm text-stone-600 mt-1">1200住宿金 或 600現金</p>
                            <p class="text-xs text-blue-600 mt-2">需年度4組成功推薦</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg border-l-4 border-purple-500">
                            <h4 class="font-semibold text-purple-700">LV3 秘境守護者</h4>
                            <p class="text-sm text-stone-600 mt-1">1500住宿金 或 800現金</p>
                            <p class="text-xs text-purple-600 mt-2">需年度10組成功推薦</p>
                        </div>
                    </div>
                    <div class="mt-4 p-4 bg-yellow-50 rounded-lg">
                        <p class="text-yellow-800 font-semibold">🎁 首次推薦獎勵</p>
                        <p class="text-sm text-yellow-700">每位大使的第一次成功推薦額外獲得 1500 住宿金</p>
                    </div>
                </div>
            </div>

            <!-- 步驟4: 範例資料 -->
            <div class="brand-card p-6">
                <h2 class="font-serif text-2xl font-semibold brand-accent mb-4">步驟4: 範例資料（可選）</h2>
                <p class="text-stone-600 mb-4">您可以在各工作表中添加以下範例資料來測試系統：</p>
                
                <div class="space-y-4">
                    <div>
                        <h3 class="text-lg font-semibold text-green-700 mb-2">Partners 範例資料</h3>
                        <div class="code-block text-xs">1	DEMO001	示範大使	demo@example.com	0912345678	LV1_INSIDER	0	0	CASH	0	0	0	台灣銀行	信義分行	示範大使	123456789012	FALSE	active		https://lin.ee/demo	FOREST_DEMO001	https://lin.ee/demo	測試用帳號	2024-01-01 00:00:00	2024-01-01 00:00:00</div>
                        <button onclick="copyToClipboard('partners-sample')" class="mt-2 px-3 py-1 bg-green-600 text-white rounded text-sm">複製範例資料</button>
                        <div id="partners-sample" class="hidden">1	DEMO001	示範大使	demo@example.com	0912345678	LV1_INSIDER	0	0	CASH	0	0	0	台灣銀行	信義分行	示範大使	123456789012	FALSE	active		https://lin.ee/demo	FOREST_DEMO001	https://lin.ee/demo	測試用帳號	2024-01-01 00:00:00	2024-01-01 00:00:00</div>
                    </div>
                </div>
            </div>

            <!-- 完成提示 -->
            <div class="brand-card p-6 bg-green-50 border-green-200">
                <h2 class="font-serif text-2xl font-semibold text-green-800 mb-4">✅ 設定完成</h2>
                <div class="space-y-2 text-green-700">
                    <p>✓ 建立4個工作表並設定標題行</p>
                    <p>✓ 了解佣金計算規則</p>
                    <p>✓ 可選：添加範例資料測試</p>
                </div>
                <div class="mt-4 p-4 bg-green-100 rounded-lg">
                    <p class="text-green-800 font-semibold">📝 下一步：</p>
                    <p class="text-sm text-green-700 mt-1">完成 Google Sheets 設定後，請複製您的 Sheets ID，然後更新 Apps Script 程式碼中的 SHEETS_ID 變數。</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                // 顯示複製成功的提示
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = '已複製 ✓';
                button.className = button.className.replace('bg-', 'bg-gray-');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.className = button.className.replace('bg-gray-', 'bg-');
                }, 2000);
            }).catch(err => {
                console.error('複製失敗:', err);
                alert('複製失敗，請手動選擇文字複製');
            });
        }
    </script>
</body>
</html>