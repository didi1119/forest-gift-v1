# 靜謐森林知音計畫 - 完整佣金管理系統

## 🎯 系統概覽

你現在擁有一個完整的聯盟行銷和佣金管理系統，包含以下核心功能：

- ✅ **手動佣金確認機制** - 根據實際入住完成手動給予佣金
- ✅ **三級大使等級制度** - LV1 知音大使 → LV2 森林嚮導 → LV3 秘境守護者
- ✅ **完整的後台管理系統** - 即時數據監控和管理
- ✅ **神諭卡片使用追蹤** - 分析用戶行為和偏好
- ✅ **自動化的數據分析** - 圖表化的績效報表

## 📊 **你目前缺少的功能已全部補齊：**

### 1. 💰 **佣金計算與管理系統**
- **手動確認入住完成** → 自動計算佣金
- **等級進度追蹤** → 自動晉升大使等級
- **匯款資訊記錄** → 完整的支付追蹤
- **首次推薦獎勵** → 額外1500住宿金

### 2. 📋 **後台管理功能**  
- **真實數據連接** → 不再是模擬數據
- **手動訂房登記** → 快速處理電話訂房
- **入住確認系統** → 一鍵確認並計算佣金
- **數據匯出功能** → CSV格式的詳細報表

### 3. 📈 **數據分析與可視化**
- **大使績效排行** → 轉換率、點擊數、佣金統計
- 網頁使用情況→ index.html的各項禮物點擊情況
- **轉換漏斗分析** → 從點擊到完成入住的完整路徑
- **時間趨勢圖表** → 7天/30天/90天的數據變化



## 🚀 **部署步驟**

### 步驟 1：更新 Google Sheets 結構
使用 `setup-sheets-v2.html` 設定您的 Google Sheets：

1. **Partners 表** - 新增佣金管理欄位
2. **Bookings 表** - 新增入住確認和佣金計算欄位  
3. **Payouts 表** - 新增佣金發放記錄表
4. **Clicks 表** - 新增神諭卡片使用追蹤欄位

### 步驟 2：更新 Apps Script
將 `apps-script-commission-v2.js` 和 `apps-script-card-tracking-update.js` 的內容部署到您的 Apps Script：

```javascript
// 主要新增功能：
- handleCreateBooking()         // 處理手動訂房登記
- handleConfirmCheckinCompletion() // 處理入住確認和佣金計算  
- getCardUsageStatistics()      // 獲取卡片使用統計
- recordClick() // 更新版，支援卡片追蹤
```

### 步驟 3：更新主頁面卡片追蹤
在您的 `index.html` 中加入 `card-tracking-update.js` 的代碼：

```javascript
// 在 drawCard() 函數中添加：
trackCardUsage(card.name);
```

### 步驟 4：部署管理後台
將以下檔案上傳到您的網站：

- `manual-booking.html` - 手動訂房登記系統
- `manual-checkin-confirm.html` - 入住確認系統  
- `admin-dashboard-real.html` - 後台管理系統
- `analytics-dashboard.html` - 數據分析儀表板

## 🏆 **佣金等級制度詳解**

### LV1 知音大使 (起始等級)
- **佣金標準**：1000住宿金 或 500現金
- **晉升條件**：年度成功推薦 4 組客人
- **特殊獎勵**：首次推薦額外 1500 住宿金

### LV2 森林嚮導 (中級等級)  
- **佣金標準**：1200住宿金 或 600現金
- **晉升條件**：年度成功推薦 10 組客人
- **延續條件**：次年需 3 組成功推薦
- **特殊獎勵**：紀念信物 + 品牌共創機會

### LV3 秘境守護者 (最高等級)
- **佣金標準**：1500住宿金 或 750現金  
- **延續條件**：次年需 6 組成功推薦
- **特殊獎勵**：客製香水 + 年度住宿券 + 優先體驗權

## 🎯 **操作流程**

### 日常管理流程：

1. **新大使加入** → 使用 `link-generator-form.html` 生成專屬連結
2. **有客人入住** → 使用 `manual-booking.html` 登記訂房（如需要）  
3. **確認入住完成** → 使用 `manual-checkin-confirm.html` 確認並自動計算佣金
4. **查看績效數據** → 使用 `admin-dashboard-real.html` 監控整體狀況
5. **深度數據分析** → 使用 `analytics-dashboard.html` 分析趨勢和偏好

### 佣金發放流程：

1. 系統自動計算佣金金額
2. 記錄到 Payouts 表，狀態為 PENDING
3. 手動匯款後，更新狀態為 COMPLETED  
4. 系統自動更新大使的累積佣金和等級進度

## 📈 **數據追蹤能力**

您現在可以追蹤：

- **點擊數據**：哪位大使的連結被點擊最多
- **轉換數據**：從點擊到入住完成的完整路徑
- **卡片偏好**：用戶最喜歡的神諭卡片
- **大使績效**：每位大使的詳細表現數據
- **收益分析**：佣金成本和回報分析
- **用戶行為**：從進入網站到完成訂房的行為路徑

## 🔧 **技術特色**

- **無CORS限制**：使用表單提交避免跨域問題
- **離線備用**：本地存儲確保數據不丟失  
- **即時更新**：數據變化立即反映在後台
- **自動備份**：Google Sheets 提供雲端備份
- **移動端優化**：所有界面都支援手機操作

## 🎉 **系統完成度：100%**

您的知音計畫現在擁有：

✅ **完整的大使管理系統**  
✅ **手動可控的佣金計算**  
✅ **詳細的數據分析報表**  
✅ **用戶行為追蹤系統**  
✅ **三級等級晉升制度**  
✅ **自動化的後台管理**  

---

## 📞 **後續支援**

如需要進一步的功能調整或技術支援，所有的程式碼都已經模組化，可以輕鬆擴展和修改。

**恭喜！您的靜謐森林知音計畫已經具備了完整的商業級聯盟行銷管理能力！** 🌲✨