<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŸ¥éŸ³å¤§ä½¿å°ˆå±¬é€£çµç”Ÿæˆå™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700&family=Noto+Sans+TC:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #FDFBF8;
            color: #5C544B;
        }
        h1, h2, h3, .font-serif {
            font-family: 'Noto Serif TC', serif;
        }
        .brand-accent {
            color: #2E4B36;
        }
        .brand-card {
            background-color: #FFFFFF;
            border: 1px solid #EAE6E1;
            border-radius: 1.5rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.05);
        }
        .link-box {
            background-color: #F8F5F2;
            border: 2px dashed #2E4B36;
            border-radius: 0.75rem;
            padding: 1rem;
            font-family: monospace;
            font-size: 0.9rem;
            word-break: break-all;
        }
    </style>
</head>
<body class="antialiased min-h-screen py-12">
    <div class="max-w-4xl mx-auto px-6">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold brand-accent mb-4">çŸ¥éŸ³å¤§ä½¿å°ˆå±¬é€£çµç”Ÿæˆå™¨</h1>
            <p class="text-lg text-stone-600">ç‚ºæ¯ä½çŸ¥éŸ³å¤§ä½¿ç”Ÿæˆå€‹äººåŒ–çš„åˆ†äº«é€£çµä¸¦å¯«å…¥ Google Sheets</p>
        </header>

        <div class="brand-card p-8 mb-8">
            <h2 class="font-serif text-2xl font-semibold brand-accent mb-6">ç”Ÿæˆå°ˆå±¬é€£çµ</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div>
                    <label class="block text-sm font-medium text-stone-700 mb-2">å¤¥ä¼´å§“å *</label>
                    <input type="text" id="partnerName" placeholder="ä¾‹ï¼šç‹å°æ˜" class="w-full p-3 border-2 border-stone-200 rounded-lg focus:border-green-800 focus:outline-none">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-stone-700 mb-2">å¤¥ä¼´ä»£ç¢¼ *</label>
                    <input type="text" id="partnerCode" placeholder="ä¾‹ï¼šWANG001 æˆ– xiaoming" class="w-full p-3 border-2 border-stone-200 rounded-lg focus:border-green-800 focus:outline-none">
                    <p class="text-xs text-stone-500 mt-1">å»ºè­°æ ¼å¼ï¼šå¤§å¯«å­—æ¯+æ•¸å­—ï¼Œä¾‹å¦‚ WANG001</p>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-stone-700 mb-2">Email</label>
                    <input type="email" id="partnerEmail" placeholder="partner@example.com" class="w-full p-3 border-2 border-stone-200 rounded-lg focus:border-green-800 focus:outline-none">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-stone-700 mb-2">å„ªæƒ åˆ¸ä»£ç¢¼</label>
                    <input type="text" id="couponCode" placeholder="ä¾‹ï¼šFOREST_WANG001" class="w-full p-3 border-2 border-stone-200 rounded-lg focus:border-green-800 focus:outline-none">
                    <p class="text-xs text-stone-500 mt-1">é¸å¡«ï¼šå¦‚æœ‰å°ˆå±¬å„ªæƒ åˆ¸å¯å¡«å…¥</p>
                </div>
            </div>
            
            <div class="space-y-3">
                <button onclick="generateLinks()" class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition duration-300">
                    ğŸ”— ç”Ÿæˆå°ˆå±¬é€£çµ
                </button>
                
                <button onclick="saveToSheets()" class="w-full bg-green-800 text-white py-3 px-6 rounded-lg font-semibold hover:bg-green-900 transition duration-300">
                    ğŸ’¾ å„²å­˜åˆ° Google Sheets
                </button>
                
                <p class="text-xs text-stone-500 text-center">
                    ç”Ÿæˆé€£çµå¾Œï¼Œè«‹é»æ“Šã€Œå„²å­˜åˆ° Google Sheetsã€å°‡è³‡æ–™å¯«å…¥ç³»çµ±
                </p>
            </div>
        </div>

        <div id="resultSection" class="brand-card p-8 hidden">
            <h3 class="font-serif text-xl font-semibold brand-accent mb-4">ç”Ÿæˆçµæœ</h3>
            
            <div class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-stone-700 mb-2">ä¸»é é€£çµï¼ˆé€éä¸­ç¹¼æœå‹™è¿½è¹¤ï¼‰</label>
                    <div class="link-box" id="landingLink">ç”Ÿæˆä¸­...</div>
                    <button onclick="copyText('landingLink')" class="mt-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">è¤‡è£½é€£çµ</button>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-stone-700 mb-2">å„ªæƒ åˆ¸é€£çµï¼ˆé€éä¸­ç¹¼æœå‹™è¿½è¹¤ï¼‰</label>
                    <div class="link-box" id="couponLink">ç”Ÿæˆä¸­...</div>
                    <button onclick="copyText('couponLink')" class="mt-2 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">è¤‡è£½é€£çµ</button>
                </div>
                
                <div class="bg-amber-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-amber-800 mb-2">ğŸ“± åˆ†äº«ç¯„æœ¬</h4>
                    <div class="text-sm text-amber-700 leading-relaxed">
                        <p id="shareTemplate"></p>
                    </div>
                    <button onclick="copyText('shareTemplate')" class="mt-3 px-3 py-1 bg-amber-600 text-white text-xs rounded hover:bg-amber-700">è¤‡è£½ç¯„æœ¬</button>
                </div>
                
                <div id="saveStatus" class="bg-gray-50 p-4 rounded-lg hidden">
                    <p class="text-gray-700">â³ å°šæœªå„²å­˜åˆ°ç³»çµ±</p>
                </div>
            </div>
        </div>

        <div class="brand-card p-8 mt-8">
            <h3 class="font-serif text-xl font-semibold brand-accent mb-4">ç³»çµ±èªªæ˜</h3>
            <div class="space-y-3 text-sm text-stone-600">
                <p><strong class="text-stone-800">é€£çµè¿½è¹¤ï¼š</strong>æ‰€æœ‰é€£çµéƒ½æœƒé€šé Apps Script ä¸­ç¹¼æœå‹™é€²è¡Œé»æ“Šè¿½è¹¤</p>
                <p><strong class="text-stone-800">è³‡æ–™ç®¡ç†ï¼š</strong>å¤¥ä¼´è³‡æ–™æœƒå„²å­˜åœ¨ Google Sheetsï¼Œä½œç‚ºç³»çµ±è³‡æ–™åº«</p>
                <p><strong class="text-stone-800">ç¸¾æ•ˆçµ±è¨ˆï¼š</strong>ç³»çµ±æ¯æ—¥è‡ªå‹•å½™æ•´é»æ“Šæ•¸èˆ‡è½‰æ›æ•¸æ“š</p>
                <p><strong class="text-stone-800">çé‡‘è¨ˆç®—ï¼š</strong>åƒ…å·²ä»˜è²»ä¸”å¯¦éš›å…¥ä½çš„è¨‚æˆ¿æ‰ç®—æœ‰æ•ˆè½‰æ›</p>
            </div>
        </div>
    </div>

    <script>
        // è¨­å®šå€¼ï¼ˆéƒ¨ç½²å®Œæˆå¾Œæœƒè‡ªå‹•æ›´æ–°ï¼‰
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/DEPLOYMENT_PLACEHOLDER/exec'; 
        const GITHUB_PAGES_URL = 'https://didi1119.github.io/forest-gift-v1'; 
        const LINE_COUPON_URL = 'https://line.me/R/ti/p/@foresthouse'; // è«‹æä¾›å¯¦éš› LINE å¸³è™Ÿ
        
        let generatedData = null;
        
        function generateLinks() {
            const partnerCode = document.getElementById('partnerCode').value.trim();
            const partnerName = document.getElementById('partnerName').value.trim();
            const partnerEmail = document.getElementById('partnerEmail').value.trim();
            const couponCode = document.getElementById('couponCode').value.trim();
            
            if (!partnerCode || !partnerName) {
                alert('è«‹å¡«å¯«å¤¥ä¼´ä»£ç¢¼å’Œå§“å');
                return;
            }
            
            // ç”Ÿæˆé€é Apps Script ä¸­ç¹¼çš„é€£çµ
            const landingUrl = `${APPS_SCRIPT_URL}?pid=${encodeURIComponent(partnerCode)}&dest=landing`;
            const couponUrl = `${APPS_SCRIPT_URL}?pid=${encodeURIComponent(partnerCode)}&dest=coupon`;
            
            // ç”Ÿæˆåˆ†äº«ç¯„æœ¬
            const shareText = `ğŸŒ² ä¾†è‡ªéœè¬æ£®æ—çš„ç‰¹åˆ¥é‚€è«‹

è¦ªæ„›çš„æœ‹å‹ï¼Œæˆ‘æƒ³èˆ‡ä½ åˆ†äº«ä¸€å€‹å¾ˆç‰¹åˆ¥çš„åœ°æ–¹ â€”â€” ä¸€ç‰‡èƒ½è®“å¿ƒéˆçœŸæ­£ä¼‘æ¯çš„æ£®æ—ã€‚

é€™è£¡ä¸åªæ˜¯ä½å®¿ï¼Œæ›´æ˜¯ä¸€å ´å›åˆ°å…§å¿ƒå®¶åœ’çš„æ—…ç¨‹ã€‚æˆ‘ç‚ºä½ æº–å‚™äº†ä¸€ä»½å°ˆå±¬çš„æ£®æ—ç¦®ç‰©ï¼Œå¸Œæœ›èƒ½ç‚ºä½ çš„ç”Ÿæ´»å¸¶ä¾†ä¸€äº›ä¸ä¸€æ¨£çš„å¯§éœèˆ‡æ„Ÿå‹•ã€‚

ğŸ é»æ“Šé€£çµï¼Œé–‹å§‹ä½ çš„æ£®æ—ä¹‹æ—…ï¼š
${landingUrl}

æœŸå¾…ä½ ä¹Ÿèƒ½åœ¨é€™è£¡ï¼Œæ‰¾åˆ°å±¬æ–¼è‡ªå·±çš„é‚£ä»½å®‰éœã€‚

â€”â€” ${partnerName} çœŸèª æ¨è–¦ â¤ï¸`;
            
            // ä¿å­˜ç”Ÿæˆçš„è³‡æ–™
            generatedData = {
                partner_code: partnerCode,
                name: partnerName,
                email: partnerEmail,
                coupon_code: couponCode,
                landing_link: landingUrl,
                coupon_link: couponUrl
            };
            
            // é¡¯ç¤ºçµæœ
            document.getElementById('landingLink').textContent = landingUrl;
            document.getElementById('couponLink').textContent = couponUrl;
            document.getElementById('shareTemplate').textContent = shareText;
            document.getElementById('resultSection').classList.remove('hidden');
            document.getElementById('saveStatus').classList.remove('hidden');
            
            // æ»¾å‹•åˆ°çµæœå€åŸŸ
            document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
        }
        
        async function saveToSheets() {
            if (!generatedData) {
                alert('è«‹å…ˆç”Ÿæˆé€£çµ');
                return;
            }
            
            const button = document.querySelector('button[onclick="saveToSheets()"]');
            const originalText = button.textContent;
            button.textContent = 'å„²å­˜ä¸­...';
            button.disabled = true;
            
            try {
                // é€™è£¡æ‡‰è©²å‘¼å«å¯¦éš›çš„ Apps Script æˆ–å¾Œç«¯ API
                // æš«æ™‚ä½¿ç”¨æ¨¡æ“¬çš„ä¿å­˜æ“ä½œ
                
                console.log('å„²å­˜è³‡æ–™åˆ° Google Sheets:', generatedData);
                
                // æ¨¡æ“¬ API å‘¼å«
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // æ›´æ–°å„²å­˜ç‹€æ…‹
                document.getElementById('saveStatus').innerHTML = `
                    <p class="text-green-700">âœ… å·²æˆåŠŸå„²å­˜åˆ°ç³»çµ±</p>
                    <p class="text-sm text-gray-600 mt-1">å¤¥ä¼´ä»£ç¢¼ï¼š${generatedData.partner_code}</p>
                `;
                document.getElementById('saveStatus').className = 'bg-green-50 p-4 rounded-lg';
                
                alert('âœ… å¤¥ä¼´è³‡æ–™å·²å„²å­˜åˆ° Google Sheetsï¼');
                
            } catch (error) {
                console.error('å„²å­˜å¤±æ•—:', error);
                alert('âŒ å„²å­˜å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
                
                document.getElementById('saveStatus').innerHTML = `
                    <p class="text-red-700">âŒ å„²å­˜å¤±æ•—</p>
                `;
                document.getElementById('saveStatus').className = 'bg-red-50 p-4 rounded-lg';
                
            } finally {
                button.textContent = originalText;
                button.disabled = false;
            }
        }
        
        function copyText(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent || element.innerText;
            
            navigator.clipboard.writeText(text).then(() => {
                showToast('âœ… å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿');
            }).catch(err => {
                console.error('è¤‡è£½å¤±æ•—:', err);
                // é€€åŒ–æ–¹æ¡ˆï¼šé¸å–æ–‡å­—
                const range = document.createRange();
                range.selectNode(element);
                window.getSelection().removeAllRanges();
                window.getSelection().addRange(range);
                alert('è«‹æŒ‰ Ctrl+C è¤‡è£½');
            });
        }
        
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded shadow-lg z-50 transition-opacity';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => {
                    if (toast.parentNode) {
                        document.body.removeChild(toast);
                    }
                }, 300);
            }, 2000);
        }
        
        // è‡ªå‹•ç”Ÿæˆå¤¥ä¼´ä»£ç¢¼å»ºè­°
        document.getElementById('partnerName').addEventListener('input', function() {
            const name = this.value.trim();
            if (name && !document.getElementById('partnerCode').value) {
                // ç°¡å–®çš„ä¸­æ–‡è½‰æ‹¼éŸ³é‚è¼¯ï¼ˆå¯ä»¥ä½¿ç”¨æ›´å®Œæ•´çš„åº«ï¼‰
                const suggestion = name.replace(/\s+/g, '').toUpperCase() + '001';
                document.getElementById('partnerCode').placeholder = `å»ºè­°ï¼š${suggestion}`;
            }
        });
    </script>
</body>
</html> 